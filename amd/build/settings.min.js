define(["jquery","core/modal_factory","core/templates","core/str","core/notification","core/ajax"],function(a,b,c,d,e,f){return{init:function(){var e="#id_safeassign_api, #id_safeassign_instructor_username, #id_safeassign_instructor_password, #id_safeassign_student_username, #id_safeassign_student_password",g=function(b){a("#id_test_credentials").attr("disabled","disabled"),a("#id_test_credentials").attr("value",b)},h=d.get_string("button_disabled","plagiarism_safeassign");a.when(h).done(function(b){a(e).each(function(){if(""==a(this).val())return g(b),!1}),a(e).on("input",function(){g(b)})});var i=function(b,c){c?a(b).hasClass("alert-warning")?a(b).removeClass("alert-warning").addClass("alert-success"):a(b).hasClass("alert-danger")&&a(b).removeClass("alert-danger").addClass("alert-success"):a(b).hasClass("alert-warning")?a(b).removeClass("alert-warning").addClass("alert-danger"):a(b).hasClass("alert-success")&&a(b).removeClass("alert-success").addClass("alert-danger")},j=a("#id_test_credentials"),k=d.get_strings([{key:"test_credentials",component:"plagiarism_safeassign"},{key:"safeassign_credentials_verified",component:"plagiarism_safeassign"},{key:"safeassign_credentials_fail",component:"plagiarism_safeassign"}]),l=[];a.when(k).done(function(a){l=a,b.create({title:a[0],body:c.render("plagiarism_safeassign/modal",{}),type:b.types.DEFAULT},j)});var m=function(b){a(b).hasClass("alert-success")?a(b).removeClass("alert-success").addClass("alert-warning"):a(b).hasClass("alert-danger")&&a(b).removeClass("alert-danger").addClass("alert-warning")},n=function(b,c,d,e,g,h){var j=f.call([{methodname:"plagiarism_safeassign_test_api_credentials",args:{username:d,password:e,baseurl:g,userid:h}}])[0];j.done(function(d){d.success?(i(c,!0),a(b).text(l[1])):(i(c,!1),a(b).text(l[2]))}).fail(function(d){i(c,!1),a(b).text(l[2])})};j.click(function(b){b.preventDefault(),m("#instructor_credentials"),a("#instructor_result").text("..."),m("#student_credentials"),a("#student_result").text("...");var c=a("#id_safeassign_instructor_username").val(),d=a("#id_safeassign_instructor_password").val(),e=a("#id_safeassign_student_username").val(),f=a("#id_safeassign_student_password").val(),g=a("input[name=userid]").val(),h=a("#id_safeassign_api").val();n("#instructor_result","#instructor_credentials",c,d,h,g),n("#student_result","#student_credentials",e,f,h,g)})}}});