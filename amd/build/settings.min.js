define(["jquery","core/modal_factory","core/templates","core/str","core/notification","core/ajax"],function(a,b,c,d,e,f){return{init:function(e){var g="#id_safeassign_api, #id_safeassign_instructor_username, #id_safeassign_instructor_password, #id_safeassign_student_username, #id_safeassign_student_password",h=function(b){a("#id_test_credentials").attr("disabled","disabled"),a("#id_test_credentials").attr("value",b)},i=d.get_string("button_disabled","plagiarism_safeassign");a.when(i).done(function(b){a(g).each(function(){""==a(this).val()&&h(b)}),a(g).on("input",function(){h(b)});var c=a("#id_safeassign_api").val();c!=e&&h(b)});var j=function(b,c){c?a(b).hasClass("alert-warning")?a(b).removeClass("alert-warning").addClass("alert-success"):a(b).hasClass("alert-danger")&&a(b).removeClass("alert-danger").addClass("alert-success"):a(b).hasClass("alert-warning")?a(b).removeClass("alert-warning").addClass("alert-danger"):a(b).hasClass("alert-success")&&a(b).removeClass("alert-success").addClass("alert-danger")},k=a("#id_test_credentials"),l=d.get_strings([{key:"test_credentials",component:"plagiarism_safeassign"},{key:"safeassign_credentials_verified",component:"plagiarism_safeassign"},{key:"safeassign_credentials_fail",component:"plagiarism_safeassign"}]),m=[];a.when(l).done(function(a){m=a,b.create({title:a[0],body:c.render("plagiarism_safeassign/modal",{}),type:b.types.DEFAULT},k)});var n=function(b){a(b).hasClass("alert-success")?a(b).removeClass("alert-success").addClass("alert-warning"):a(b).hasClass("alert-danger")&&a(b).removeClass("alert-danger").addClass("alert-warning")},o=function(b,c,d,e,g,h){var i=f.call([{methodname:"plagiarism_safeassign_test_api_credentials",args:{username:d,password:e,baseurl:g,userid:h}}])[0];i.done(function(d){d.success?(j(c,!0),a(b).text(m[1])):(j(c,!1),a(b).text(m[2]))}).fail(function(){j(c,!1),a(b).text(m[2])})};k.click(function(b){b.preventDefault(),n("#instructor_credentials"),a("#instructor_result").text("..."),n("#student_credentials"),a("#student_result").text("...");var c=a("#id_safeassign_instructor_username").val(),d=a("#id_safeassign_instructor_password").val(),e=a("#id_safeassign_student_username").val(),f=a("#id_safeassign_student_password").val(),g=a("input[name=userid]").val(),h=a("#id_safeassign_api").val();o("#instructor_result","#instructor_credentials",c,d,h,g),o("#student_result","#student_credentials",e,f,h,g)})}}});