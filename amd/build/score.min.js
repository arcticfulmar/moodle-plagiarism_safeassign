define(["jquery","core/str"],function(a,b){return{init:function(c,d,e){var f=function(b){var c=a(b);return!!c.length},g=function(b){if(!f("#safeassign_score_"+d)){var g=a(b),h=a("<td></td>").attr("id","safeassign_text_"+d);h.addClass("ygtvcell ygtvhtml ygtvcontent");var j=a("<tr></tr>").addClass("ygtvrow").append(h),k=a("<table></table>").attr("id","safeassign_score_"+d).append(j),l=a("<div></div>").addClass("ygtvitem").append(k);if(g.prepend(l),e){var m=a("<td></td>").attr("id","safeassign_or_"+d).addClass("ygtvcell ygtvhtml ygtvcontent");m.append(e);var n=a("<tr></tr>").addClass("ygtvrow").append(m);a("#safeassign_score_"+d).append(n)}i(c,"#safeassign_text_"+d)}},h=function(b){if(!f("#safeassign_online_sub_"+d)){var g=a(b).parent(),h=a("<div></div>").attr("id","safeassign_online_sub_"+d);if(e){var j=a("<div></div>").attr("id","safeassign_online_or_"+d);j.append(e),g.prepend(j)}g.prepend(h),i(c,"#safeassign_online_sub_"+d)}},i=function(c,d){var e=b.get_string("safeassign_overall_score","plagiarism_safeassign",c);a.when(e).done(function(b){a(d).append(b)})},j=function(b,c){c=c?c:10;var d=a.Deferred(),e=0,g=setInterval(function(){e+=1,e>c?(d.reject(),clearInterval(g)):f(b)&&(d.resolve(),clearInterval(g))},200);return d.promise()},k=a("#page-mod-assign-grading"),l=k.length,m=".ygtvchildren",n=".plagiarism-inline.online-text-div";l&&(m=".user"+d+" .ygtvchildren",n=".user"+d+" td div.plagiarism-inline.online-text-div");var o=j(m,20);o.then(function(){g(m)});var p=j(n,20);p.then(function(){h(n)})}}});