define(["jquery","core/str"],function(a,b){return{init:function(c,d){var e=function(b){var c=a(b);return!!c.length},f=function(b){if(!e("#safeassign_text_"+d)){var f=a(b),g=a("<td></td>").attr("id","safeassign_text_"+d);g.addClass("ygtvcell ygtvhtml ygtvcontent");var i=a("<tr></tr>").addClass("ygtvrow").append(g),j=a("<table></table>").attr("id","safeassign_score_"+d).append(i),k=a("<div></div>").addClass("ygtvitem").append(j);f.prepend(k),h(c,"#safeassign_text_"+d)}},g=function(b){if(!e("#safeassign_online_sub_"+d)){var f=a(b).parent(),g=a("<div></div>").attr("id","safeassign_online_sub_"+d);f.prepend(g),h(c,"#safeassign_online_sub_"+d)}},h=function(c,d){var e=b.get_string("safeassign_overall_score","plagiarism_safeassign",c);a.when(e).done(function(b){a(d).append(b)})},i=function(b,c){c=c?c:10;var d=a.Deferred(),f=0,g=setInterval(function(){f+=1,f>c?(d.reject(),clearInterval(g)):e(b)&&(d.resolve(),clearInterval(g))},200);return d.promise()},j=a("#page-mod-assign-grading"),k=j.length,l=".ygtvchildren";k&&(l=".user"+d+" .ygtvchildren");var m=".plagiarism-inline.online-text-div",n=i(l,20);n.then(function(){f(l)});var o=i(m,20);o.then(function(){g(m)})}}});